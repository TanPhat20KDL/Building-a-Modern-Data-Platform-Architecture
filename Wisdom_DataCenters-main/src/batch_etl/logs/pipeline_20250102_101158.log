2025-01-02 17:11:59,077 - __main__ - INFO - Starting logistics data pipeline
User: ponydasierra
Environment: development
Start Time (UTC): 2025-01-02 10:11:56.087256
2025-01-02 17:11:59,077 - __main__ - INFO - Starting data extraction phase
2025-01-02 17:11:59,077 - __main__ - INFO - Processing table: Orders
2025-01-02 17:11:59,077 - src.batch_etl.extract.mysql_extractor - INFO - Starting extraction of table Orders
2025-01-02 17:12:02,577 - src.batch_etl.extract.mysql_extractor - INFO - Completed extraction of Orders:
Records: 500
Partitions: 4
Duration: 3.11 seconds
2025-01-02 17:12:02,698 - src.batch_etl.load.datalake_loader - INFO - Starting raw zone load for Orders
2025-01-02 17:12:05,849 - src.batch_etl.load.datalake_loader - INFO - Completed raw zone load for Orders:
Records: 500
Partitioning: partitioned by ['created_at_partition', 'status']
Duration: 3.07 seconds
Path: /user/thuanpony03/logistics/data/datalake/raw/Orders
2025-01-02 17:12:05,849 - __main__ - INFO - Completed Orders: 500 records processed in 6.77 seconds
2025-01-02 17:12:05,849 - __main__ - INFO - Processing table: Shipments
2025-01-02 17:12:05,849 - src.batch_etl.extract.mysql_extractor - INFO - Starting extraction of table Shipments
2025-01-02 17:12:05,982 - src.batch_etl.extract.mysql_extractor - INFO - Completed extraction of Shipments:
Records: 371
Partitions: 4
Duration: 0.05 seconds
2025-01-02 17:12:06,040 - src.batch_etl.load.datalake_loader - INFO - Starting raw zone load for Shipments
2025-01-02 17:12:07,132 - src.batch_etl.load.datalake_loader - INFO - Completed raw zone load for Shipments:
Records: 371
Partitioning: partitioned by ['status']
Duration: 1.04 seconds
Path: /user/thuanpony03/logistics/data/datalake/raw/Shipments
2025-01-02 17:12:07,132 - __main__ - INFO - Completed Shipments: 371 records processed in 1.28 seconds
2025-01-02 17:12:07,132 - __main__ - INFO - Processing table: Payments
2025-01-02 17:12:07,132 - src.batch_etl.extract.mysql_extractor - INFO - Starting extraction of table Payments
2025-01-02 17:12:07,239 - src.batch_etl.extract.mysql_extractor - INFO - Completed extraction of Payments:
Records: 500
Partitions: 4
Duration: 0.04 seconds
2025-01-02 17:12:07,334 - src.batch_etl.load.datalake_loader - INFO - Starting raw zone load for Payments
2025-01-02 17:12:08,401 - src.batch_etl.load.datalake_loader - INFO - Completed raw zone load for Payments:
Records: 500
Partitioning: partitioned by ['payment_date_partition', 'payment_status']
Duration: 1.02 seconds
Path: /user/thuanpony03/logistics/data/datalake/raw/Payments
2025-01-02 17:12:08,401 - __main__ - INFO - Completed Payments: 500 records processed in 1.27 seconds
2025-01-02 17:12:08,401 - __main__ - INFO - Processing table: Notifications
2025-01-02 17:12:08,401 - src.batch_etl.extract.mysql_extractor - INFO - Starting extraction of table Notifications
2025-01-02 17:12:08,494 - src.batch_etl.extract.mysql_extractor - INFO - Completed extraction of Notifications:
Records: 371
Partitions: 4
Duration: 0.04 seconds
2025-01-02 17:12:08,545 - src.batch_etl.load.datalake_loader - INFO - Starting raw zone load for Notifications
2025-01-02 17:12:09,182 - src.batch_etl.load.datalake_loader - INFO - Completed raw zone load for Notifications:
Records: 371
Partitioning: partitioned by ['notification_date_partition']
Duration: 0.60 seconds
Path: /user/thuanpony03/logistics/data/datalake/raw/Notifications
2025-01-02 17:12:09,183 - __main__ - INFO - Completed Notifications: 371 records processed in 0.78 seconds
2025-01-02 17:12:09,183 - __main__ - INFO - Processing table: Users
2025-01-02 17:12:09,183 - src.batch_etl.extract.mysql_extractor - INFO - Starting extraction of table Users
2025-01-02 17:12:09,239 - src.batch_etl.extract.mysql_extractor - INFO - Completed extraction of Users:
Records: 100
Partitions: 1
Duration: 0.01 seconds
2025-01-02 17:12:09,279 - src.batch_etl.load.datalake_loader - INFO - Starting raw zone load for Users
2025-01-02 17:12:09,813 - src.batch_etl.load.datalake_loader - INFO - Completed raw zone load for Users:
Records: 100
Partitioning: not partitioned
Duration: 0.50 seconds
Path: /user/thuanpony03/logistics/data/datalake/raw/Users
2025-01-02 17:12:09,813 - __main__ - INFO - Completed Users: 100 records processed in 0.63 seconds
2025-01-02 17:12:09,813 - __main__ - INFO - Processing table: Drivers
2025-01-02 17:12:09,813 - src.batch_etl.extract.mysql_extractor - INFO - Starting extraction of table Drivers
2025-01-02 17:12:09,869 - src.batch_etl.extract.mysql_extractor - INFO - Completed extraction of Drivers:
Records: 20
Partitions: 1
Duration: 0.01 seconds
2025-01-02 17:12:09,903 - src.batch_etl.load.datalake_loader - INFO - Starting raw zone load for Drivers
2025-01-02 17:12:10,431 - src.batch_etl.load.datalake_loader - INFO - Completed raw zone load for Drivers:
Records: 20
Partitioning: not partitioned
Duration: 0.48 seconds
Path: /user/thuanpony03/logistics/data/datalake/raw/Drivers
2025-01-02 17:12:10,431 - __main__ - INFO - Completed Drivers: 20 records processed in 0.62 seconds
2025-01-02 17:12:10,431 - __main__ - INFO - Data extraction phase completed in 11.35 seconds
2025-01-02 17:12:10,431 - __main__ - INFO - Starting data transformation phase
2025-01-02 17:12:10,431 - src.batch_etl.transform.transform_executor - INFO - Starting transformation process
Timestamp: 2024-12-24 09:43:35
User: thuanpony03
2025-01-02 17:12:10,431 - src.batch_etl.transform.transform_executor - INFO - Starting dimension transformation at 2024-12-24 09:43:35
2025-01-02 17:12:10,431 - src.batch_etl.transform.dimension_builder - INFO - Building date dimension from 2024-01-01 to 2024-12-31
2025-01-02 17:12:10,812 - src.batch_etl.transform.dimension_builder - INFO - Successfully built date dimension with 366 rows
2025-01-02 17:12:11,120 - src.batch_etl.transform.dimension_builder - INFO - Building user dimension
2025-01-02 17:12:11,343 - src.batch_etl.transform.dimension_builder - INFO - Successfully built user dimension with 100 rows
2025-01-02 17:12:11,343 - src.batch_etl.transform.dimension_builder - INFO - Building driver dimension
2025-01-02 17:12:11,704 - src.batch_etl.transform.dimension_builder - INFO - Successfully built driver dimension with 20 rows
2025-01-02 17:12:11,717 - src.batch_etl.transform.dimension_builder - INFO - Building location dimension
2025-01-02 17:12:12,418 - src.batch_etl.transform.dimension_builder - INFO - Successfully built location dimension with 1000 unique addresses
2025-01-02 17:12:13,272 - src.batch_etl.transform.transform_executor - INFO - Completed dimension transformation with counts:
date: 366 rows
user: 100 rows
driver: 20 rows
location: 1000 rows
2025-01-02 17:12:13,272 - src.batch_etl.transform.transform_executor - INFO - Starting fact transformation at 2024-12-24 09:43:35
2025-01-02 17:12:13,431 - src.batch_etl.transform.fact_builder - INFO - Building orders fact table
2025-01-02 17:12:13,787 - src.batch_etl.transform.fact_builder - ERROR - Error building orders fact table: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `payment_method_key` cannot be resolved. Did you mean one of the following? [`payment_method`, `payment_status`, `order_date_key`, `delivery_date_key`, `pickup_location_key`].;
'Project [row_number() windowspecdefinition(order_id#896 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS order_key#1256, order_id#896, user_key#639, order_date_key#989, pickup_location_key#1078, delivery_location_key#1204, 'payment_method_key, package_weight#901, amount#946 AS order_amount#1257, delivery_duration_minutes#1229, status#909 AS order_status#1258, payment_status#954, created_at#903 AS order_created_at#1259, delivery_time#902 AS order_completed_at#1260]
+- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, delivery_location_key#1204, full_address#1151, CASE WHEN isnotnull(delivery_time#902) THEN round((cast((unix_timestamp(delivery_time#902, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false) - unix_timestamp(created_at#903, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false)) as double) / cast(60 as double)), 0) ELSE cast(null as double) END AS delivery_duration_minutes#1229]
   +- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, location_key#802 AS delivery_location_key#1204, full_address#1151]
      +- Join LeftOuter, (delivery_address#899 = full_address#1151)
         :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, location_key#802 AS pickup_location_key#1078, full_address#787]
         :  +- Join LeftOuter, (pickup_address#898 = full_address#787)
         :     :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639]
         :     :  +- Join LeftOuter, (user_id#897 = user_id#527)
         :     :     :- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, cast(date_format(created_at#903, yyyyMMdd, Some(Asia/Vientiane)) as int) AS order_date_key#989, cast(date_format(delivery_time#902, yyyyMMdd, Some(Asia/Vientiane)) as int) AS delivery_date_key#990]
         :     :     :  +- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954]
         :     :     :     +- Join LeftOuter, (order_id#896 = order_id#945)
         :     :     :        :- Relation [order_id#896,user_id#897,pickup_address#898,delivery_address#899,package_description#900,package_weight#901,delivery_time#902,created_at#903,dl_ingestion_timestamp#904,dl_source_table#905,dl_batch_id#906,dl_process_date#907,created_at_partition#908,status#909] parquet
         :     :     :        +- Project [order_id#945, amount#946, payment_method#947, payment_status#954]
         :     :     :           +- Relation [payment_id#944,order_id#945,amount#946,payment_method#947,payment_date#948,dl_ingestion_timestamp#949,dl_source_table#950,dl_batch_id#951,dl_process_date#952,payment_date_partition#953,payment_status#954] parquet
         :     :     +- Project [user_key#639, user_id#527]
         :     :        +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639]
         :     :           +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639, user_key#639]
         :     :              +- Window [row_number() windowspecdefinition(user_id#527 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#639], [user_id#527 ASC NULLS FIRST]
         :     :                 +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627]
         :     :                    +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, true AS is_active#625, coalesce(cast(created_at#534 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#626, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#627]
         :     :                       +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534]
         :     :                          +- Relation [user_id#527,full_name#528,email#529,password_hash#530,phone_number#531,address#532,role#533,created_at#534,dl_ingestion_timestamp#535,dl_source_table#536,dl_batch_id#537,dl_process_date#538] parquet
         :     +- SubqueryAlias pickup_loc
         :        +- Project [location_key#802, full_address#787]
         :           +- Project [location_key#802, full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :              +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
         :                 +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
         :                    +- Window [row_number() windowspecdefinition(full_address#787 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#787 ASC NULLS FIRST]
         :                       +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :                          +- Project [full_address#787, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
         :                             +- Project [full_address#787, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
         :                                +- Deduplicate [full_address#787]
         :                                   +- Project [trim(address#756, None) AS full_address#787]
         :                                      +- Union false, false
         :                                         :- Project [pickup_address#571 AS address#756]
         :                                         :  +- Join Cross
         :                                         :     :- Project [pickup_address#571, delivery_address#572]
         :                                         :     :  +- Relation [order_id#569,user_id#570,pickup_address#571,delivery_address#572,package_description#573,package_weight#574,delivery_time#575,created_at#576,dl_ingestion_timestamp#577,dl_source_table#578,dl_batch_id#579,dl_process_date#580,created_at_partition#581,status#582] parquet
         :                                         :     +- Project [current_location#600]
         :                                         :        +- Relation [shipment_id#597,order_id#598,driver_id#599,current_location#600,estimated_delivery_time#601,dl_ingestion_timestamp#602,dl_source_table#603,dl_batch_id#604,dl_process_date#605,status#606] parquet
         :                                         +- Project [delivery_address#763 AS address#758]
         :                                            +- Join Cross
         :                                               :- Project [pickup_address#762, delivery_address#763]
         :                                               :  +- Relation [order_id#760,user_id#761,pickup_address#762,delivery_address#763,package_description#764,package_weight#765,delivery_time#766,created_at#767,dl_ingestion_timestamp#768,dl_source_table#769,dl_batch_id#770,dl_process_date#771,created_at_partition#772,status#773] parquet
         :                                               +- Project [current_location#777]
         :                                                  +- Relation [shipment_id#774,order_id#775,driver_id#776,current_location#777,estimated_delivery_time#778,dl_ingestion_timestamp#779,dl_source_table#780,dl_batch_id#781,dl_process_date#782,status#783] parquet
         +- SubqueryAlias delivery_loc
            +- Project [location_key#802, full_address#1151]
               +- Project [location_key#802, full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                  +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
                     +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
                        +- Window [row_number() windowspecdefinition(full_address#1151 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#1151 ASC NULLS FIRST]
                           +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                              +- Project [full_address#1151, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
                                 +- Project [full_address#1151, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
                                    +- Deduplicate [full_address#1151]
                                       +- Project [trim(address#756, None) AS full_address#1151]
                                          +- Union false, false
                                             :- Project [pickup_address#1105 AS address#756]
                                             :  +- Join Cross
                                             :     :- Project [pickup_address#1105, delivery_address#1106]
                                             :     :  +- Relation [order_id#1103,user_id#1104,pickup_address#1105,delivery_address#1106,package_description#1107,package_weight#1108,delivery_time#1109,created_at#1110,dl_ingestion_timestamp#1111,dl_source_table#1112,dl_batch_id#1113,dl_process_date#1114,created_at_partition#1115,status#1116] parquet
                                             :     +- Project [current_location#1120]
                                             :        +- Relation [shipment_id#1117,order_id#1118,driver_id#1119,current_location#1120,estimated_delivery_time#1121,dl_ingestion_timestamp#1122,dl_source_table#1123,dl_batch_id#1124,dl_process_date#1125,status#1126] parquet
                                             +- Project [delivery_address#1130 AS address#758]
                                                +- Join Cross
                                                   :- Project [pickup_address#1129, delivery_address#1130]
                                                   :  +- Relation [order_id#1127,user_id#1128,pickup_address#1129,delivery_address#1130,package_description#1131,package_weight#1132,delivery_time#1133,created_at#1134,dl_ingestion_timestamp#1135,dl_source_table#1136,dl_batch_id#1137,dl_process_date#1138,created_at_partition#1139,status#1140] parquet
                                                   +- Project [current_location#1144]
                                                      +- Relation [shipment_id#1141,order_id#1142,driver_id#1143,current_location#1144,estimated_delivery_time#1145,dl_ingestion_timestamp#1146,dl_source_table#1147,dl_batch_id#1148,dl_process_date#1149,status#1150] parquet

2025-01-02 17:12:13,789 - src.batch_etl.transform.transform_executor - ERROR - Error in fact transformation: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `payment_method_key` cannot be resolved. Did you mean one of the following? [`payment_method`, `payment_status`, `order_date_key`, `delivery_date_key`, `pickup_location_key`].;
'Project [row_number() windowspecdefinition(order_id#896 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS order_key#1256, order_id#896, user_key#639, order_date_key#989, pickup_location_key#1078, delivery_location_key#1204, 'payment_method_key, package_weight#901, amount#946 AS order_amount#1257, delivery_duration_minutes#1229, status#909 AS order_status#1258, payment_status#954, created_at#903 AS order_created_at#1259, delivery_time#902 AS order_completed_at#1260]
+- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, delivery_location_key#1204, full_address#1151, CASE WHEN isnotnull(delivery_time#902) THEN round((cast((unix_timestamp(delivery_time#902, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false) - unix_timestamp(created_at#903, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false)) as double) / cast(60 as double)), 0) ELSE cast(null as double) END AS delivery_duration_minutes#1229]
   +- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, location_key#802 AS delivery_location_key#1204, full_address#1151]
      +- Join LeftOuter, (delivery_address#899 = full_address#1151)
         :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, location_key#802 AS pickup_location_key#1078, full_address#787]
         :  +- Join LeftOuter, (pickup_address#898 = full_address#787)
         :     :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639]
         :     :  +- Join LeftOuter, (user_id#897 = user_id#527)
         :     :     :- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, cast(date_format(created_at#903, yyyyMMdd, Some(Asia/Vientiane)) as int) AS order_date_key#989, cast(date_format(delivery_time#902, yyyyMMdd, Some(Asia/Vientiane)) as int) AS delivery_date_key#990]
         :     :     :  +- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954]
         :     :     :     +- Join LeftOuter, (order_id#896 = order_id#945)
         :     :     :        :- Relation [order_id#896,user_id#897,pickup_address#898,delivery_address#899,package_description#900,package_weight#901,delivery_time#902,created_at#903,dl_ingestion_timestamp#904,dl_source_table#905,dl_batch_id#906,dl_process_date#907,created_at_partition#908,status#909] parquet
         :     :     :        +- Project [order_id#945, amount#946, payment_method#947, payment_status#954]
         :     :     :           +- Relation [payment_id#944,order_id#945,amount#946,payment_method#947,payment_date#948,dl_ingestion_timestamp#949,dl_source_table#950,dl_batch_id#951,dl_process_date#952,payment_date_partition#953,payment_status#954] parquet
         :     :     +- Project [user_key#639, user_id#527]
         :     :        +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639]
         :     :           +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639, user_key#639]
         :     :              +- Window [row_number() windowspecdefinition(user_id#527 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#639], [user_id#527 ASC NULLS FIRST]
         :     :                 +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627]
         :     :                    +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, true AS is_active#625, coalesce(cast(created_at#534 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#626, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#627]
         :     :                       +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534]
         :     :                          +- Relation [user_id#527,full_name#528,email#529,password_hash#530,phone_number#531,address#532,role#533,created_at#534,dl_ingestion_timestamp#535,dl_source_table#536,dl_batch_id#537,dl_process_date#538] parquet
         :     +- SubqueryAlias pickup_loc
         :        +- Project [location_key#802, full_address#787]
         :           +- Project [location_key#802, full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :              +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
         :                 +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
         :                    +- Window [row_number() windowspecdefinition(full_address#787 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#787 ASC NULLS FIRST]
         :                       +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :                          +- Project [full_address#787, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
         :                             +- Project [full_address#787, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
         :                                +- Deduplicate [full_address#787]
         :                                   +- Project [trim(address#756, None) AS full_address#787]
         :                                      +- Union false, false
         :                                         :- Project [pickup_address#571 AS address#756]
         :                                         :  +- Join Cross
         :                                         :     :- Project [pickup_address#571, delivery_address#572]
         :                                         :     :  +- Relation [order_id#569,user_id#570,pickup_address#571,delivery_address#572,package_description#573,package_weight#574,delivery_time#575,created_at#576,dl_ingestion_timestamp#577,dl_source_table#578,dl_batch_id#579,dl_process_date#580,created_at_partition#581,status#582] parquet
         :                                         :     +- Project [current_location#600]
         :                                         :        +- Relation [shipment_id#597,order_id#598,driver_id#599,current_location#600,estimated_delivery_time#601,dl_ingestion_timestamp#602,dl_source_table#603,dl_batch_id#604,dl_process_date#605,status#606] parquet
         :                                         +- Project [delivery_address#763 AS address#758]
         :                                            +- Join Cross
         :                                               :- Project [pickup_address#762, delivery_address#763]
         :                                               :  +- Relation [order_id#760,user_id#761,pickup_address#762,delivery_address#763,package_description#764,package_weight#765,delivery_time#766,created_at#767,dl_ingestion_timestamp#768,dl_source_table#769,dl_batch_id#770,dl_process_date#771,created_at_partition#772,status#773] parquet
         :                                               +- Project [current_location#777]
         :                                                  +- Relation [shipment_id#774,order_id#775,driver_id#776,current_location#777,estimated_delivery_time#778,dl_ingestion_timestamp#779,dl_source_table#780,dl_batch_id#781,dl_process_date#782,status#783] parquet
         +- SubqueryAlias delivery_loc
            +- Project [location_key#802, full_address#1151]
               +- Project [location_key#802, full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                  +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
                     +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
                        +- Window [row_number() windowspecdefinition(full_address#1151 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#1151 ASC NULLS FIRST]
                           +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                              +- Project [full_address#1151, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
                                 +- Project [full_address#1151, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
                                    +- Deduplicate [full_address#1151]
                                       +- Project [trim(address#756, None) AS full_address#1151]
                                          +- Union false, false
                                             :- Project [pickup_address#1105 AS address#756]
                                             :  +- Join Cross
                                             :     :- Project [pickup_address#1105, delivery_address#1106]
                                             :     :  +- Relation [order_id#1103,user_id#1104,pickup_address#1105,delivery_address#1106,package_description#1107,package_weight#1108,delivery_time#1109,created_at#1110,dl_ingestion_timestamp#1111,dl_source_table#1112,dl_batch_id#1113,dl_process_date#1114,created_at_partition#1115,status#1116] parquet
                                             :     +- Project [current_location#1120]
                                             :        +- Relation [shipment_id#1117,order_id#1118,driver_id#1119,current_location#1120,estimated_delivery_time#1121,dl_ingestion_timestamp#1122,dl_source_table#1123,dl_batch_id#1124,dl_process_date#1125,status#1126] parquet
                                             +- Project [delivery_address#1130 AS address#758]
                                                +- Join Cross
                                                   :- Project [pickup_address#1129, delivery_address#1130]
                                                   :  +- Relation [order_id#1127,user_id#1128,pickup_address#1129,delivery_address#1130,package_description#1131,package_weight#1132,delivery_time#1133,created_at#1134,dl_ingestion_timestamp#1135,dl_source_table#1136,dl_batch_id#1137,dl_process_date#1138,created_at_partition#1139,status#1140] parquet
                                                   +- Project [current_location#1144]
                                                      +- Relation [shipment_id#1141,order_id#1142,driver_id#1143,current_location#1144,estimated_delivery_time#1145,dl_ingestion_timestamp#1146,dl_source_table#1147,dl_batch_id#1148,dl_process_date#1149,status#1150] parquet

2025-01-02 17:12:13,792 - src.batch_etl.transform.transform_executor - ERROR - Transform process failed: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `payment_method_key` cannot be resolved. Did you mean one of the following? [`payment_method`, `payment_status`, `order_date_key`, `delivery_date_key`, `pickup_location_key`].;
'Project [row_number() windowspecdefinition(order_id#896 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS order_key#1256, order_id#896, user_key#639, order_date_key#989, pickup_location_key#1078, delivery_location_key#1204, 'payment_method_key, package_weight#901, amount#946 AS order_amount#1257, delivery_duration_minutes#1229, status#909 AS order_status#1258, payment_status#954, created_at#903 AS order_created_at#1259, delivery_time#902 AS order_completed_at#1260]
+- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, delivery_location_key#1204, full_address#1151, CASE WHEN isnotnull(delivery_time#902) THEN round((cast((unix_timestamp(delivery_time#902, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false) - unix_timestamp(created_at#903, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false)) as double) / cast(60 as double)), 0) ELSE cast(null as double) END AS delivery_duration_minutes#1229]
   +- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, location_key#802 AS delivery_location_key#1204, full_address#1151]
      +- Join LeftOuter, (delivery_address#899 = full_address#1151)
         :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, location_key#802 AS pickup_location_key#1078, full_address#787]
         :  +- Join LeftOuter, (pickup_address#898 = full_address#787)
         :     :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639]
         :     :  +- Join LeftOuter, (user_id#897 = user_id#527)
         :     :     :- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, cast(date_format(created_at#903, yyyyMMdd, Some(Asia/Vientiane)) as int) AS order_date_key#989, cast(date_format(delivery_time#902, yyyyMMdd, Some(Asia/Vientiane)) as int) AS delivery_date_key#990]
         :     :     :  +- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954]
         :     :     :     +- Join LeftOuter, (order_id#896 = order_id#945)
         :     :     :        :- Relation [order_id#896,user_id#897,pickup_address#898,delivery_address#899,package_description#900,package_weight#901,delivery_time#902,created_at#903,dl_ingestion_timestamp#904,dl_source_table#905,dl_batch_id#906,dl_process_date#907,created_at_partition#908,status#909] parquet
         :     :     :        +- Project [order_id#945, amount#946, payment_method#947, payment_status#954]
         :     :     :           +- Relation [payment_id#944,order_id#945,amount#946,payment_method#947,payment_date#948,dl_ingestion_timestamp#949,dl_source_table#950,dl_batch_id#951,dl_process_date#952,payment_date_partition#953,payment_status#954] parquet
         :     :     +- Project [user_key#639, user_id#527]
         :     :        +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639]
         :     :           +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639, user_key#639]
         :     :              +- Window [row_number() windowspecdefinition(user_id#527 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#639], [user_id#527 ASC NULLS FIRST]
         :     :                 +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627]
         :     :                    +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, true AS is_active#625, coalesce(cast(created_at#534 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#626, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#627]
         :     :                       +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534]
         :     :                          +- Relation [user_id#527,full_name#528,email#529,password_hash#530,phone_number#531,address#532,role#533,created_at#534,dl_ingestion_timestamp#535,dl_source_table#536,dl_batch_id#537,dl_process_date#538] parquet
         :     +- SubqueryAlias pickup_loc
         :        +- Project [location_key#802, full_address#787]
         :           +- Project [location_key#802, full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :              +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
         :                 +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
         :                    +- Window [row_number() windowspecdefinition(full_address#787 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#787 ASC NULLS FIRST]
         :                       +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :                          +- Project [full_address#787, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
         :                             +- Project [full_address#787, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
         :                                +- Deduplicate [full_address#787]
         :                                   +- Project [trim(address#756, None) AS full_address#787]
         :                                      +- Union false, false
         :                                         :- Project [pickup_address#571 AS address#756]
         :                                         :  +- Join Cross
         :                                         :     :- Project [pickup_address#571, delivery_address#572]
         :                                         :     :  +- Relation [order_id#569,user_id#570,pickup_address#571,delivery_address#572,package_description#573,package_weight#574,delivery_time#575,created_at#576,dl_ingestion_timestamp#577,dl_source_table#578,dl_batch_id#579,dl_process_date#580,created_at_partition#581,status#582] parquet
         :                                         :     +- Project [current_location#600]
         :                                         :        +- Relation [shipment_id#597,order_id#598,driver_id#599,current_location#600,estimated_delivery_time#601,dl_ingestion_timestamp#602,dl_source_table#603,dl_batch_id#604,dl_process_date#605,status#606] parquet
         :                                         +- Project [delivery_address#763 AS address#758]
         :                                            +- Join Cross
         :                                               :- Project [pickup_address#762, delivery_address#763]
         :                                               :  +- Relation [order_id#760,user_id#761,pickup_address#762,delivery_address#763,package_description#764,package_weight#765,delivery_time#766,created_at#767,dl_ingestion_timestamp#768,dl_source_table#769,dl_batch_id#770,dl_process_date#771,created_at_partition#772,status#773] parquet
         :                                               +- Project [current_location#777]
         :                                                  +- Relation [shipment_id#774,order_id#775,driver_id#776,current_location#777,estimated_delivery_time#778,dl_ingestion_timestamp#779,dl_source_table#780,dl_batch_id#781,dl_process_date#782,status#783] parquet
         +- SubqueryAlias delivery_loc
            +- Project [location_key#802, full_address#1151]
               +- Project [location_key#802, full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                  +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
                     +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
                        +- Window [row_number() windowspecdefinition(full_address#1151 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#1151 ASC NULLS FIRST]
                           +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                              +- Project [full_address#1151, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
                                 +- Project [full_address#1151, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
                                    +- Deduplicate [full_address#1151]
                                       +- Project [trim(address#756, None) AS full_address#1151]
                                          +- Union false, false
                                             :- Project [pickup_address#1105 AS address#756]
                                             :  +- Join Cross
                                             :     :- Project [pickup_address#1105, delivery_address#1106]
                                             :     :  +- Relation [order_id#1103,user_id#1104,pickup_address#1105,delivery_address#1106,package_description#1107,package_weight#1108,delivery_time#1109,created_at#1110,dl_ingestion_timestamp#1111,dl_source_table#1112,dl_batch_id#1113,dl_process_date#1114,created_at_partition#1115,status#1116] parquet
                                             :     +- Project [current_location#1120]
                                             :        +- Relation [shipment_id#1117,order_id#1118,driver_id#1119,current_location#1120,estimated_delivery_time#1121,dl_ingestion_timestamp#1122,dl_source_table#1123,dl_batch_id#1124,dl_process_date#1125,status#1126] parquet
                                             +- Project [delivery_address#1130 AS address#758]
                                                +- Join Cross
                                                   :- Project [pickup_address#1129, delivery_address#1130]
                                                   :  +- Relation [order_id#1127,user_id#1128,pickup_address#1129,delivery_address#1130,package_description#1131,package_weight#1132,delivery_time#1133,created_at#1134,dl_ingestion_timestamp#1135,dl_source_table#1136,dl_batch_id#1137,dl_process_date#1138,created_at_partition#1139,status#1140] parquet
                                                   +- Project [current_location#1144]
                                                      +- Relation [shipment_id#1141,order_id#1142,driver_id#1143,current_location#1144,estimated_delivery_time#1145,dl_ingestion_timestamp#1146,dl_source_table#1147,dl_batch_id#1148,dl_process_date#1149,status#1150] parquet

2025-01-02 17:12:13,795 - __main__ - ERROR - Error in transformation phase: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `payment_method_key` cannot be resolved. Did you mean one of the following? [`payment_method`, `payment_status`, `order_date_key`, `delivery_date_key`, `pickup_location_key`].;
'Project [row_number() windowspecdefinition(order_id#896 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS order_key#1256, order_id#896, user_key#639, order_date_key#989, pickup_location_key#1078, delivery_location_key#1204, 'payment_method_key, package_weight#901, amount#946 AS order_amount#1257, delivery_duration_minutes#1229, status#909 AS order_status#1258, payment_status#954, created_at#903 AS order_created_at#1259, delivery_time#902 AS order_completed_at#1260]
+- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, delivery_location_key#1204, full_address#1151, CASE WHEN isnotnull(delivery_time#902) THEN round((cast((unix_timestamp(delivery_time#902, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false) - unix_timestamp(created_at#903, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false)) as double) / cast(60 as double)), 0) ELSE cast(null as double) END AS delivery_duration_minutes#1229]
   +- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, location_key#802 AS delivery_location_key#1204, full_address#1151]
      +- Join LeftOuter, (delivery_address#899 = full_address#1151)
         :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, location_key#802 AS pickup_location_key#1078, full_address#787]
         :  +- Join LeftOuter, (pickup_address#898 = full_address#787)
         :     :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639]
         :     :  +- Join LeftOuter, (user_id#897 = user_id#527)
         :     :     :- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, cast(date_format(created_at#903, yyyyMMdd, Some(Asia/Vientiane)) as int) AS order_date_key#989, cast(date_format(delivery_time#902, yyyyMMdd, Some(Asia/Vientiane)) as int) AS delivery_date_key#990]
         :     :     :  +- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954]
         :     :     :     +- Join LeftOuter, (order_id#896 = order_id#945)
         :     :     :        :- Relation [order_id#896,user_id#897,pickup_address#898,delivery_address#899,package_description#900,package_weight#901,delivery_time#902,created_at#903,dl_ingestion_timestamp#904,dl_source_table#905,dl_batch_id#906,dl_process_date#907,created_at_partition#908,status#909] parquet
         :     :     :        +- Project [order_id#945, amount#946, payment_method#947, payment_status#954]
         :     :     :           +- Relation [payment_id#944,order_id#945,amount#946,payment_method#947,payment_date#948,dl_ingestion_timestamp#949,dl_source_table#950,dl_batch_id#951,dl_process_date#952,payment_date_partition#953,payment_status#954] parquet
         :     :     +- Project [user_key#639, user_id#527]
         :     :        +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639]
         :     :           +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639, user_key#639]
         :     :              +- Window [row_number() windowspecdefinition(user_id#527 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#639], [user_id#527 ASC NULLS FIRST]
         :     :                 +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627]
         :     :                    +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, true AS is_active#625, coalesce(cast(created_at#534 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#626, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#627]
         :     :                       +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534]
         :     :                          +- Relation [user_id#527,full_name#528,email#529,password_hash#530,phone_number#531,address#532,role#533,created_at#534,dl_ingestion_timestamp#535,dl_source_table#536,dl_batch_id#537,dl_process_date#538] parquet
         :     +- SubqueryAlias pickup_loc
         :        +- Project [location_key#802, full_address#787]
         :           +- Project [location_key#802, full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :              +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
         :                 +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
         :                    +- Window [row_number() windowspecdefinition(full_address#787 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#787 ASC NULLS FIRST]
         :                       +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :                          +- Project [full_address#787, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
         :                             +- Project [full_address#787, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
         :                                +- Deduplicate [full_address#787]
         :                                   +- Project [trim(address#756, None) AS full_address#787]
         :                                      +- Union false, false
         :                                         :- Project [pickup_address#571 AS address#756]
         :                                         :  +- Join Cross
         :                                         :     :- Project [pickup_address#571, delivery_address#572]
         :                                         :     :  +- Relation [order_id#569,user_id#570,pickup_address#571,delivery_address#572,package_description#573,package_weight#574,delivery_time#575,created_at#576,dl_ingestion_timestamp#577,dl_source_table#578,dl_batch_id#579,dl_process_date#580,created_at_partition#581,status#582] parquet
         :                                         :     +- Project [current_location#600]
         :                                         :        +- Relation [shipment_id#597,order_id#598,driver_id#599,current_location#600,estimated_delivery_time#601,dl_ingestion_timestamp#602,dl_source_table#603,dl_batch_id#604,dl_process_date#605,status#606] parquet
         :                                         +- Project [delivery_address#763 AS address#758]
         :                                            +- Join Cross
         :                                               :- Project [pickup_address#762, delivery_address#763]
         :                                               :  +- Relation [order_id#760,user_id#761,pickup_address#762,delivery_address#763,package_description#764,package_weight#765,delivery_time#766,created_at#767,dl_ingestion_timestamp#768,dl_source_table#769,dl_batch_id#770,dl_process_date#771,created_at_partition#772,status#773] parquet
         :                                               +- Project [current_location#777]
         :                                                  +- Relation [shipment_id#774,order_id#775,driver_id#776,current_location#777,estimated_delivery_time#778,dl_ingestion_timestamp#779,dl_source_table#780,dl_batch_id#781,dl_process_date#782,status#783] parquet
         +- SubqueryAlias delivery_loc
            +- Project [location_key#802, full_address#1151]
               +- Project [location_key#802, full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                  +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
                     +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
                        +- Window [row_number() windowspecdefinition(full_address#1151 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#1151 ASC NULLS FIRST]
                           +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                              +- Project [full_address#1151, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
                                 +- Project [full_address#1151, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
                                    +- Deduplicate [full_address#1151]
                                       +- Project [trim(address#756, None) AS full_address#1151]
                                          +- Union false, false
                                             :- Project [pickup_address#1105 AS address#756]
                                             :  +- Join Cross
                                             :     :- Project [pickup_address#1105, delivery_address#1106]
                                             :     :  +- Relation [order_id#1103,user_id#1104,pickup_address#1105,delivery_address#1106,package_description#1107,package_weight#1108,delivery_time#1109,created_at#1110,dl_ingestion_timestamp#1111,dl_source_table#1112,dl_batch_id#1113,dl_process_date#1114,created_at_partition#1115,status#1116] parquet
                                             :     +- Project [current_location#1120]
                                             :        +- Relation [shipment_id#1117,order_id#1118,driver_id#1119,current_location#1120,estimated_delivery_time#1121,dl_ingestion_timestamp#1122,dl_source_table#1123,dl_batch_id#1124,dl_process_date#1125,status#1126] parquet
                                             +- Project [delivery_address#1130 AS address#758]
                                                +- Join Cross
                                                   :- Project [pickup_address#1129, delivery_address#1130]
                                                   :  +- Relation [order_id#1127,user_id#1128,pickup_address#1129,delivery_address#1130,package_description#1131,package_weight#1132,delivery_time#1133,created_at#1134,dl_ingestion_timestamp#1135,dl_source_table#1136,dl_batch_id#1137,dl_process_date#1138,created_at_partition#1139,status#1140] parquet
                                                   +- Project [current_location#1144]
                                                      +- Relation [shipment_id#1141,order_id#1142,driver_id#1143,current_location#1144,estimated_delivery_time#1145,dl_ingestion_timestamp#1146,dl_source_table#1147,dl_batch_id#1148,dl_process_date#1149,status#1150] parquet

2025-01-02 17:12:13,796 - __main__ - ERROR - Pipeline failed: [UNRESOLVED_COLUMN.WITH_SUGGESTION] A column or function parameter with name `payment_method_key` cannot be resolved. Did you mean one of the following? [`payment_method`, `payment_status`, `order_date_key`, `delivery_date_key`, `pickup_location_key`].;
'Project [row_number() windowspecdefinition(order_id#896 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS order_key#1256, order_id#896, user_key#639, order_date_key#989, pickup_location_key#1078, delivery_location_key#1204, 'payment_method_key, package_weight#901, amount#946 AS order_amount#1257, delivery_duration_minutes#1229, status#909 AS order_status#1258, payment_status#954, created_at#903 AS order_created_at#1259, delivery_time#902 AS order_completed_at#1260]
+- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, delivery_location_key#1204, full_address#1151, CASE WHEN isnotnull(delivery_time#902) THEN round((cast((unix_timestamp(delivery_time#902, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false) - unix_timestamp(created_at#903, yyyy-MM-dd HH:mm:ss, Some(Asia/Vientiane), false)) as double) / cast(60 as double)), 0) ELSE cast(null as double) END AS delivery_duration_minutes#1229]
   +- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, pickup_location_key#1078, full_address#787, location_key#802 AS delivery_location_key#1204, full_address#1151]
      +- Join LeftOuter, (delivery_address#899 = full_address#1151)
         :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639, location_key#802 AS pickup_location_key#1078, full_address#787]
         :  +- Join LeftOuter, (pickup_address#898 = full_address#787)
         :     :- Project [user_id#897, order_id#896, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, order_date_key#989, delivery_date_key#990, user_key#639]
         :     :  +- Join LeftOuter, (user_id#897 = user_id#527)
         :     :     :- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954, cast(date_format(created_at#903, yyyyMMdd, Some(Asia/Vientiane)) as int) AS order_date_key#989, cast(date_format(delivery_time#902, yyyyMMdd, Some(Asia/Vientiane)) as int) AS delivery_date_key#990]
         :     :     :  +- Project [order_id#896, user_id#897, pickup_address#898, delivery_address#899, package_description#900, package_weight#901, delivery_time#902, created_at#903, dl_ingestion_timestamp#904, dl_source_table#905, dl_batch_id#906, dl_process_date#907, created_at_partition#908, status#909, amount#946, payment_method#947, payment_status#954]
         :     :     :     +- Join LeftOuter, (order_id#896 = order_id#945)
         :     :     :        :- Relation [order_id#896,user_id#897,pickup_address#898,delivery_address#899,package_description#900,package_weight#901,delivery_time#902,created_at#903,dl_ingestion_timestamp#904,dl_source_table#905,dl_batch_id#906,dl_process_date#907,created_at_partition#908,status#909] parquet
         :     :     :        +- Project [order_id#945, amount#946, payment_method#947, payment_status#954]
         :     :     :           +- Relation [payment_id#944,order_id#945,amount#946,payment_method#947,payment_date#948,dl_ingestion_timestamp#949,dl_source_table#950,dl_batch_id#951,dl_process_date#952,payment_date_partition#953,payment_status#954] parquet
         :     :     +- Project [user_key#639, user_id#527]
         :     :        +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639]
         :     :           +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627, user_key#639, user_key#639]
         :     :              +- Window [row_number() windowspecdefinition(user_id#527 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS user_key#639], [user_id#527 ASC NULLS FIRST]
         :     :                 +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, is_active#625, effective_start_date#626, effective_end_date#627]
         :     :                    +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534, true AS is_active#625, coalesce(cast(created_at#534 as date), current_date(Some(Asia/Vientiane))) AS effective_start_date#626, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#627]
         :     :                       +- Project [user_id#527, full_name#528, email#529, phone_number#531, address#532, role#533, created_at#534]
         :     :                          +- Relation [user_id#527,full_name#528,email#529,password_hash#530,phone_number#531,address#532,role#533,created_at#534,dl_ingestion_timestamp#535,dl_source_table#536,dl_batch_id#537,dl_process_date#538] parquet
         :     +- SubqueryAlias pickup_loc
         :        +- Project [location_key#802, full_address#787]
         :           +- Project [location_key#802, full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :              +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
         :                 +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
         :                    +- Window [row_number() windowspecdefinition(full_address#787 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#787 ASC NULLS FIRST]
         :                       +- Project [full_address#787, city#789, district#790, effective_start_date#794, effective_end_date#795]
         :                          +- Project [full_address#787, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
         :                             +- Project [full_address#787, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#787, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
         :                                +- Deduplicate [full_address#787]
         :                                   +- Project [trim(address#756, None) AS full_address#787]
         :                                      +- Union false, false
         :                                         :- Project [pickup_address#571 AS address#756]
         :                                         :  +- Join Cross
         :                                         :     :- Project [pickup_address#571, delivery_address#572]
         :                                         :     :  +- Relation [order_id#569,user_id#570,pickup_address#571,delivery_address#572,package_description#573,package_weight#574,delivery_time#575,created_at#576,dl_ingestion_timestamp#577,dl_source_table#578,dl_batch_id#579,dl_process_date#580,created_at_partition#581,status#582] parquet
         :                                         :     +- Project [current_location#600]
         :                                         :        +- Relation [shipment_id#597,order_id#598,driver_id#599,current_location#600,estimated_delivery_time#601,dl_ingestion_timestamp#602,dl_source_table#603,dl_batch_id#604,dl_process_date#605,status#606] parquet
         :                                         +- Project [delivery_address#763 AS address#758]
         :                                            +- Join Cross
         :                                               :- Project [pickup_address#762, delivery_address#763]
         :                                               :  +- Relation [order_id#760,user_id#761,pickup_address#762,delivery_address#763,package_description#764,package_weight#765,delivery_time#766,created_at#767,dl_ingestion_timestamp#768,dl_source_table#769,dl_batch_id#770,dl_process_date#771,created_at_partition#772,status#773] parquet
         :                                               +- Project [current_location#777]
         :                                                  +- Relation [shipment_id#774,order_id#775,driver_id#776,current_location#777,estimated_delivery_time#778,dl_ingestion_timestamp#779,dl_source_table#780,dl_batch_id#781,dl_process_date#782,status#783] parquet
         +- SubqueryAlias delivery_loc
            +- Project [location_key#802, full_address#1151]
               +- Project [location_key#802, full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                  +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802]
                     +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795, location_key#802, location_key#802]
                        +- Window [row_number() windowspecdefinition(full_address#1151 ASC NULLS FIRST, specifiedwindowframe(RowFrame, unboundedpreceding$(), currentrow$())) AS location_key#802], [full_address#1151 ASC NULLS FIRST]
                           +- Project [full_address#1151, city#789, district#790, effective_start_date#794, effective_end_date#795]
                              +- Project [full_address#1151, city#789, district#790, current_date(Some(Asia/Vientiane)) AS effective_start_date#794, to_date(9999-12-31, None, Some(Asia/Vientiane)) AS effective_end_date#795]
                                 +- Project [full_address#1151, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+$), 1) ELSE cast(null as string) END AS city#789, CASE WHEN NOT (regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) = ) THEN regexp_extract(full_address#1151, (?i)(?:,\s*)([^,]+)(?:,\s*[^,]+,), 1) ELSE cast(null as string) END AS district#790]
                                    +- Deduplicate [full_address#1151]
                                       +- Project [trim(address#756, None) AS full_address#1151]
                                          +- Union false, false
                                             :- Project [pickup_address#1105 AS address#756]
                                             :  +- Join Cross
                                             :     :- Project [pickup_address#1105, delivery_address#1106]
                                             :     :  +- Relation [order_id#1103,user_id#1104,pickup_address#1105,delivery_address#1106,package_description#1107,package_weight#1108,delivery_time#1109,created_at#1110,dl_ingestion_timestamp#1111,dl_source_table#1112,dl_batch_id#1113,dl_process_date#1114,created_at_partition#1115,status#1116] parquet
                                             :     +- Project [current_location#1120]
                                             :        +- Relation [shipment_id#1117,order_id#1118,driver_id#1119,current_location#1120,estimated_delivery_time#1121,dl_ingestion_timestamp#1122,dl_source_table#1123,dl_batch_id#1124,dl_process_date#1125,status#1126] parquet
                                             +- Project [delivery_address#1130 AS address#758]
                                                +- Join Cross
                                                   :- Project [pickup_address#1129, delivery_address#1130]
                                                   :  +- Relation [order_id#1127,user_id#1128,pickup_address#1129,delivery_address#1130,package_description#1131,package_weight#1132,delivery_time#1133,created_at#1134,dl_ingestion_timestamp#1135,dl_source_table#1136,dl_batch_id#1137,dl_process_date#1138,created_at_partition#1139,status#1140] parquet
                                                   +- Project [current_location#1144]
                                                      +- Relation [shipment_id#1141,order_id#1142,driver_id#1143,current_location#1144,estimated_delivery_time#1145,dl_ingestion_timestamp#1146,dl_source_table#1147,dl_batch_id#1148,dl_process_date#1149,status#1150] parquet

2025-01-02 17:12:13,810 - py4j.clientserver - INFO - Closing down clientserver connection
